<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carbon-Neural Dashboard - Deep Analysis</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Inter', sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            overflow-x: hidden;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        /* Background Effects */
        .bg-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: 
                radial-gradient(circle at 20% 80%, rgba(0, 51, 102, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(0, 102, 51, 0.12) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(51, 0, 102, 0.08) 0%, transparent 50%);
        }
        
        /* Navigation */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(10, 10, 10, 0.9);
            backdrop-filter: blur(25px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 16px 40px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 1000;
        }
        
        .logo {
            font-size: 22px;
            font-weight: 700;
            color: #00ff7f;
            letter-spacing: -0.5px;
        }
        
        .nav-status {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 13px;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #00ff7f;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        
        /* Main Layout */
        .dashboard {
            padding: 80px 20px 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .dashboard-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .dashboard-title {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #ffffff 0%, #00ff7f 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .dashboard-subtitle {
            color: rgba(255, 255, 255, 0.6);
            font-size: 1rem;
        }
        
        /* Grid Layout */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }
        
        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00ff7f, transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .metric-card:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(0, 255, 127, 0.3);
            transform: translateY(-4px);
        }
        
        .metric-card:hover::before {
            opacity: 1;
        }
        
        .metric-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }
        
        .metric-title {
            font-size: 14px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.8);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .metric-icon {
            font-size: 18px;
        }
        
        .metric-value {
            font-size: 2.2rem;
            font-weight: 800;
            color: #ffffff;
            margin-bottom: 8px;
            letter-spacing: -1px;
        }
        
        .metric-change {
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .metric-change.positive {
            color: #ff6b6b;
        }
        
        .metric-change.negative {
            color: #00ff7f;
        }
        
        /* Chart Containers */
        .chart-container {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
        }
        
        .chart-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #ffffff;
        }
        
        .chart-controls {
            display: flex;
            gap: 8px;
        }
        
        .chart-btn {
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .chart-btn.active {
            background: #00ff7f;
            color: #000000;
            border-color: #00ff7f;
        }
        
        .chart-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1);
        }
        
        /* 3D Visualization Container */
        .viz-3d {
            height: 400px;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }
        
        .viz-3d canvas {
            width: 100% !important;
            height: 100% !important;
        }
        
        /* Data Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }
        
        .data-table th {
            background: rgba(0, 255, 127, 0.1);
            color: #00ff7f;
            padding: 12px;
            text-align: left;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid rgba(0, 255, 127, 0.2);
        }
        
        .data-table td {
            padding: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.8);
            font-size: 13px;
        }
        
        .data-table tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }
        
        /* Alerts */
        .alert {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.2);
            border-radius: 8px;
            padding: 12px 16px;
            margin: 12px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .alert.warning {
            background: rgba(255, 193, 7, 0.1);
            border-color: rgba(255, 193, 7, 0.2);
        }
        
        .alert.success {
            background: rgba(0, 255, 127, 0.1);
            border-color: rgba(0, 255, 127, 0.2);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .navbar { padding: 12px 20px; }
            .dashboard { padding: 70px 15px 20px; }
            .dashboard-title { font-size: 2rem; }
            .dashboard-grid { grid-template-columns: 1fr; }
        }
        
        /* Loading States */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            border-top-color: #00ff7f;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Prediction Model Status */
        .model-status {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .model-accuracy {
            background: rgba(0, 255, 127, 0.1);
            color: #00ff7f;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }
        
        .confidence-bar {
            flex: 1;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #ffc107, #00ff7f);
            border-radius: 3px;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>
    
    <nav class="navbar">
        <div class="logo">Carbon-Neural Dashboard</div>
        <div class="nav-status">
            <div class="status-indicator">
                <div class="status-dot"></div>
                <span>AI Engine Active</span>
            </div>
            <div class="status-indicator">
                <span id="lastUpdate">Updated 2 min ago</span>
            </div>
        </div>
    </nav>
    
    <div class="dashboard">
        <div class="dashboard-header">
            <h1 class="dashboard-title">Deep Carbon Analysis</h1>
            <p class="dashboard-subtitle">Real-time insights powered by neural networks and Hedera tokenization</p>
        </div>
        
        <!-- Key Metrics Grid -->
        <div class="dashboard-grid">
            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">Current Footprint</span>
                    <span class="metric-icon">🔥</span>
                </div>
                <div class="metric-value" id="currentFootprint">5.71</div>
                <div class="metric-change positive">
                    <span>↑ 0.23 kg</span>
                    <span>(+4.2% vs yesterday)</span>
                </div>
            </div>
            
            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">Monthly Trend</span>
                    <span class="metric-icon">📈</span>
                </div>
                <div class="metric-value">171.3</div>
                <div class="metric-change negative">
                    <span>↓ 12.4 kg</span>
                    <span>(-6.7% vs last month)</span>
                </div>
            </div>
            
            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">Carbon Credits</span>
                    <span class="metric-icon">🪙</span>
                </div>
                <div class="metric-value">47</div>
                <div class="metric-change negative">
                    <span>↓ 3 credits</span>
                    <span>(redeemed yesterday)</span>
                </div>
            </div>
            
            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-title">Prediction Accuracy</span>
                    <span class="metric-icon">🎯</span>
                </div>
                <div class="metric-value">94.2%</div>
                <div class="metric-change negative">
                    <span>↑ 1.3%</span>
                    <span>(model improving)</span>
                </div>
            </div>
        </div>
        
        <!-- AI Model Performance -->
        <div class="chart-container">
            <div class="chart-header">
                <h3 class="chart-title">🧠 Neural Network Performance</h3>
            </div>
            <div class="model-status">
                <div class="model-accuracy">R² = 0.942</div>
                <div class="confidence-bar">
                    <div class="confidence-fill" style="width: 94.2%"></div>
                </div>
                <span style="font-size: 12px; color: rgba(255, 255, 255, 0.6);">Training Loss: 0.028</span>
            </div>
            <canvas id="modelPerformance" height="300"></canvas>
        </div>
        
        <!-- Emissions Timeline -->
        <div class="chart-container">
            <div class="chart-header">
                <h3 class="chart-title">🌍 Carbon Emissions Timeline</h3>
                <div class="chart-controls">
                    <button class="chart-btn active" onclick="changeTimeframe('7d')">7D</button>
                    <button class="chart-btn" onclick="changeTimeframe('30d')">30D</button>
                    <button class="chart-btn" onclick="changeTimeframe('90d')">90D</button>
                    <button class="chart-btn" onclick="changeTimeframe('1y')">1Y</button>
                </div>
            </div>
            <canvas id="emissionsChart" height="300"></canvas>
        </div>
        
        <!-- Breakdown Analysis -->
        <div class="dashboard-grid">
            <div class="chart-container">
                <div class="chart-header">
                    <h3 class="chart-title">⚡ Energy Breakdown</h3>
                </div>
                <canvas id="breakdownChart" height="250"></canvas>
            </div>
            
            <div class="chart-container">
                <div class="chart-header">
                    <h3 class="chart-title">🚗 Transportation Impact</h3>
                </div>
                <canvas id="transportChart" height="250"></canvas>
            </div>
        </div>
        
        <!-- 3D Carbon Flow Visualization -->
        <div class="chart-container">
            <div class="chart-header">
                <h3 class="chart-title">🌐 3D Carbon Flow Visualization</h3>
                <div class="status-indicator">
                    <div class="loading"></div>
                    <span>Real-time data stream</span>
                </div>
            </div>
            <div class="viz-3d" id="carbonFlow3D"></div>
        </div>
        
        <!-- Predictive Insights -->
        <div class="chart-container">
            <div class="chart-header">
                <h3 class="chart-title">🔮 Predictive Analysis</h3>
            </div>
            
            <div class="alert warning">
                ⚠️ <strong>Peak Usage Alert:</strong> Device consumption expected to increase by 15% next week based on historical patterns.
            </div>
            
            <div class="alert success">
                ✅ <strong>Optimization Opportunity:</strong> Switching to renewable energy plan could reduce monthly emissions by 23%.
            </div>
            
            <canvas id="predictiveChart" height="300"></canvas>
        </div>
        
        <!-- Abatement Options Table -->
        <div class="chart-container">
            <div class="chart-header">
                <h3 class="chart-title">💡 Marginal Abatement Cost Curve</h3>
            </div>
            <canvas id="abatementChart" height="300"></canvas>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Option</th>
                        <th>Reduction (kg CO₂/day)</th>
                        <th>Cost ($/tCO₂)</th>
                        <th>Payback Period</th>
                        <th>Implementation</th>
                    </tr>
                </thead>
                <tbody id="abatementTable">
                    <tr>
                        <td>LED Lighting Upgrade</td>
                        <td>0.12</td>
                        <td>$15</td>
                        <td>18 months</td>
                        <td><span style="color: #00ff7f;">Ready</span></td>
                    </tr>
                    <tr>
                        <td>Smart Thermostat</td>
                        <td>0.28</td>
                        <td>$25</td>
                        <td>14 months</td>
                        <td><span style="color: #ffc107;">In Progress</span></td>
                    </tr>
                    <tr>
                        <td>Solar Panel Installation</td>
                        <td>0.45</td>
                        <td>$85</td>
                        <td>7.2 years</td>
                        <td><span style="color: #ff6b6b;">Planning</span></td>
                    </tr>
                    <tr>
                        <td>Electric Vehicle</td>
                        <td>1.23</td>
                        <td>$120</td>
                        <td>8.5 years</td>
                        <td><span style="color: #6c757d;">Under Review</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Tokenization Analytics -->
        <div class="chart-container">
            <div class="chart-header">
                <h3 class="chart-title">🪙 Carbon Credit Tokenization</h3>
            </div>
            
            <div class="dashboard-grid" style="margin-bottom: 20px;">
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Credits Generated</span>
                        <span class="metric-icon">⚡</span>
                    </div>
                    <div class="metric-value">1.7</div>
                    <div style="font-size: 12px; color: rgba(255, 255, 255, 0.6);">This month</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Token Value</span>
                        <span class="metric-icon">💎</span>
                    </div>
                    <div class="metric-value">$12.45</div>
                    <div style="font-size: 12px; color: rgba(255, 255, 255, 0.6);">Per credit</div>
                </div>
            </div>
            
            <canvas id="tokenChart" height="250"></canvas>
        </div>
    </div>
    
    <script>
        // Chart.js Global Configuration
        Chart.defaults.color = 'rgba(255, 255, 255, 0.8)';
        Chart.defaults.borderColor = 'rgba(255, 255, 255, 0.1)';
        Chart.defaults.backgroundColor = 'rgba(0, 255, 127, 0.1)';
        
        // Generate sample data
        function generateTimeSeriesData(days = 30, baseValue = 5.71) {
            const data = [];
            const labels = [];
            for (let i = days; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                labels.push(date.toLocaleDateString());
                
                const noise = (Math.random() - 0.5) * 1.5;
                const trend = -0.02 * (days - i); // Slight decreasing trend
                const seasonal = Math.sin((days - i) / 7 * Math.PI) * 0.3; // Weekly pattern
                
                data.push(Math.max(0, baseValue + trend + seasonal + noise));
            }
            return { labels, data };
        }
        
        // Model Performance Chart
        const modelCtx = document.getElementById('modelPerformance').getContext('2d');
        const modelData = generateTimeSeriesData(100, 0.95);
        
        new Chart(modelCtx, {
            type: 'line',
            data: {
                labels: modelData.labels.slice(-30),
                datasets: [
                    {
                        label: 'Model Accuracy',
                        data: modelData.data.slice(-30).map(v => Math.min(1, v)),
                        borderColor: '#00ff7f',
                        backgroundColor: 'rgba(0, 255, 127, 0.1)',
                        tension: 0.4,
                        fill: true
                    },
                    {
                        label: 'Training Loss',
                        data: modelData.data.slice(-30).map(v => Math.max(0, 1 - v) * 0.1),
                        borderColor: '#ff6b6b',
                        backgroundColor: 'rgba(255, 107, 107, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y1'
                    }
                ]
            },
            options: {
                responsive: true,
                interaction: { intersect: false },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 1,
                        title: { display: true, text: 'Accuracy' }
                    },
                    y1: {
                        type: 'linear',
                        display: true,
                        position: 'right',
                        max: 0.1,
                        title: { display: true, text: 'Loss' },
                        grid: { drawOnChartArea: false }
                    }
                },
                plugins: { legend: { position: 'top' } }
            }
        });
        
        // Emissions Timeline Chart
        const emissionsCtx = document.getElementById('emissionsChart').getContext('2d');
        const emissionsData = generateTimeSeriesData(30, 5.71);
        
        const emissionsChart = new Chart(emissionsCtx, {
            type: 'line',
            data: {
                labels: emissionsData.labels,
                datasets: [
                    {
                        label: 'Daily Emissions',
                        data: emissionsData.data,
                        borderColor: '#00bfff',
                        backgroundColor: 'rgba(0, 191, 255, 0.1)',
                        tension: 0.4,
                        fill: true
                    },
                    {
                        label: 'Predicted',
                        data: emissionsData.data.map((v, i) => i > 20 ? v * (1 + (i - 20) * 0.01) : null),
                        borderColor: '#ffc107',
                        backgroundColor: 'rgba(255, 193, 7, 0.1)',
                        borderDash: [5, 5],
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                interaction: { intersect: false },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'kg CO₂/day' }
                    }
                },
                plugins: { legend: { position: 'top' } }
            }
        });
        
        // Energy Breakdown Chart
        const breakdownCtx = document.getElementById('breakdownChart').getContext('2d');
        new Chart(breakdownCtx, {
            type: 'doughnut',
            data: {
                labels: ['Computing Devices', 'Heating/Cooling', 'Lighting', 'Appliances', 'Other'],
                datasets: [{
                    data: [35, 28, 15, 12, 10],
                    backgroundColor: [
                        'rgba(0, 255, 127, 0.8)',
                        'rgba(0, 191, 255, 0.8)',
                        'rgba(255, 193, 7, 0.8)',
                        'rgba(255, 107, 107, 0.8)',
                        'rgba(156, 39, 176, 0.8)'
                    ],
                    borderWidth: 2,
                    borderColor: '#0a0a0a'
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: 'bottom' }
                }
            }
        });
        
        // Transportation Impact Chart
        const transportCtx = document.getElementById('transportChart').getContext('2d');
        new Chart(transportCtx, {
            type: 'bar',
            data: {
                labels: ['Car', 'Public Transport', 'Walking/Cycling', 'Air Travel', 'Other'],
                datasets: [{
                    label: 'kg CO₂/day',
                    data: [2.1, 0.3, 0.0, 0.8, 0.2],
                    backgroundColor: [
                        'rgba(255, 107, 107, 0.8)',
                        'rgba(0, 255, 127, 0.8)',
                        'rgba(76, 175, 80, 0.8)',
                        'rgba(255, 193, 7, 0.8)',
                        'rgba(156, 39, 176, 0.8)'
                    ],
                    borderRadius: 4
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: { beginAtZero: true, title: { display: true, text: 'kg CO₂/day' } }
                },
                plugins: { legend: { display: false } }
            }
        });
        
        // Predictive Analysis Chart
        const predictiveCtx = document.getElementById('predictiveChart').getContext('2d');
        const futureData = generateTimeSeriesData(60, 5.71);
        
        new Chart(predictiveCtx, {
            type: 'line',
            data: {
                labels: futureData.labels,
                datasets: [
                    {
                        label: 'Historical',
                        data: futureData.data.slice(0, 30).concat(new Array(30).fill(null)),
                        borderColor: '#00ff7f',
                        backgroundColor: 'rgba(0, 255, 127, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'Predicted',
                        data: new Array(29).fill(null).concat(futureData.data.slice(29)),
                        borderColor: '#ffc107',
                        backgroundColor: 'rgba(255, 193, 7, 0.1)',
                        borderDash: [5, 5],
                        tension: 0.4
                    },
                    {
                        label: 'Confidence Interval',
                        data: new Array(29).fill(null).concat(
                            futureData.data.slice(29).map(v => v * 1.2)
                        ),
                        borderColor: 'rgba(255, 193, 7, 0.3)',
                        backgroundColor: 'rgba(255, 193, 7, 0.05)',
                        fill: '-1',
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                interaction: { intersect: false },
                scales: {
                    y: { beginAtZero: true, title: { display: true, text: 'kg CO₂/day' } }
                },
                plugins: { legend: { position: 'top' } }
            }
        });
        
        // Abatement Cost Chart
        const abatementCtx = document.getElementById('abatementChart').getContext('2d');
        new Chart(abatementCtx, {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'Abatement Options',
                    data: [
                        { x: 0.12, y: 15 },
                        { x: 0.28, y: 25 },
                        { x: 0.45, y: 85 },
                        { x: 1.23, y: 120 }
                    ],
                    backgroundColor: 'rgba(0, 255, 127, 0.8)',
                    borderColor: '#00ff7f',
                    pointRadius: 8,
                    pointHoverRadius: 12
                }]
            },
            options: {
                responsive: true,
                scales: {
                    x: { title: { display: true, text: 'CO₂ Reduction (kg/day)' } },
                    y: { title: { display: true, text: 'Cost ($/tCO₂)' } }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const options = ['LED Lighting', 'Smart Thermostat', 'Solar Panels', 'Electric Vehicle'];
                                return `${options[context.dataIndex]}: ${context.parsed.x} kg/day, $${context.parsed.y}/tCO₂`;
                            }
                        }
                    }
                }
            }
        });
        
        // Token Value Chart
        const tokenCtx = document.getElementById('tokenChart').getContext('2d');
        const tokenData = generateTimeSeriesData(30, 12.45);
        
        new Chart(tokenCtx, {
            type: 'line',
            data: {
                labels: tokenData.labels,
                datasets: [
                    {
                        label: 'Token Value ($)',
                        data: tokenData.data,
                        borderColor: '#00ff7f',
                        backgroundColor: 'rgba(0, 255, 127, 0.1)',
                        tension: 0.4,
                        fill: true
                    },
                    {
                        label: 'Volume',
                        data: tokenData.data.map(v => v * 4),
                        borderColor: '#00bfff',
                        backgroundColor: 'rgba(0, 191, 255, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y1'
                    }
                ]
            },
            options: {
                responsive: true,
                interaction: { intersect: false },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Price ($)' }
                    },
                    y1: {
                        type: 'linear',
                        display: true,
                        position: 'right',
                        title: { display: true, text: 'Volume' },
                        grid: { drawOnChartArea: false }
                    }
                },
                plugins: { legend: { position: 'top' } }
            }
        });
        
        // 3D Carbon Flow Visualization
        function init3DVisualization() {
            const container = document.getElementById('carbonFlow3D');
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, container.offsetWidth / container.offsetHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            
            renderer.setSize(container.offsetWidth, container.offsetHeight);
            renderer.setClearColor(0x000000, 0);
            container.appendChild(renderer.domElement);
            
            // Create particle system for carbon flow
            const particleCount = 1000;
            const particles = new THREE.BufferGeometry();
            const positions = new Float32Array(particleCount * 3);
            const colors = new Float32Array(particleCount * 3);
            const sizes = new Float32Array(particleCount);
            
            for (let i = 0; i < particleCount; i++) {
                positions[i * 3] = (Math.random() - 0.5) * 20;
                positions[i * 3 + 1] = (Math.random() - 0.5) * 20;
                positions[i * 3 + 2] = (Math.random() - 0.5) * 20;
                
                // Color based on emission level (red = high, green = low)
                const intensity = Math.random();
                colors[i * 3] = intensity > 0.5 ? 1 : 0; // Red
                colors[i * 3 + 1] = intensity < 0.5 ? 1 : 0; // Green
                colors[i * 3 + 2] = 0; // Blue
                
                sizes[i] = Math.random() * 2 + 1;
            }
            
            particles.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            particles.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            particles.setAttribute('size', new THREE.BufferAttribute(sizes, 1));
            
            const material = new THREE.PointsMaterial({
                size: 0.1,
                vertexColors: true,
                transparent: true,
                opacity: 0.8
            });
            
            const particleSystem = new THREE.Points(particles, material);
            scene.add(particleSystem);
            
            // Add central sphere representing carbon source
            const sphereGeometry = new THREE.SphereGeometry(1, 32, 32);
            const sphereMaterial = new THREE.MeshBasicMaterial({ 
                color: 0x00ff7f, 
                wireframe: true, 
                transparent: true, 
                opacity: 0.3 
            });
            const centralSphere = new THREE.Mesh(sphereGeometry, sphereMaterial);
            scene.add(centralSphere);
            
            camera.position.z = 15;
            
            // Animation loop
            function animate() {
                requestAnimationFrame(animate);
                
                // Rotate particle system
                particleSystem.rotation.x += 0.001;
                particleSystem.rotation.y += 0.002;
                
                // Rotate central sphere
                centralSphere.rotation.x += 0.01;
                centralSphere.rotation.y += 0.01;
                
                // Update particle positions for flow effect
                const positions = particleSystem.geometry.attributes.position.array;
                for (let i = 0; i < particleCount; i++) {
                    positions[i * 3 + 1] -= 0.02; // Downward flow
                    if (positions[i * 3 + 1] < -10) {
                        positions[i * 3 + 1] = 10; // Reset to top
                    }
                }
                particleSystem.geometry.attributes.position.needsUpdate = true;
                
                renderer.render(scene, camera);
            }
            animate();
            
            // Handle resize
            window.addEventListener('resize', () => {
                camera.aspect = container.offsetWidth / container.offsetHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.offsetWidth, container.offsetHeight);
            });
        }
        
        // Initialize 3D visualization
        setTimeout(init3DVisualization, 1000);
        
        // Interactive functions
        function changeTimeframe(period) {
            // Remove active class from all buttons
            document.querySelectorAll('.chart-btn').forEach(btn => btn.classList.remove('active'));
            // Add active class to clicked button
            event.target.classList.add('active');
            
            // Update chart data based on selected timeframe
            let days;
            switch(period) {
                case '7d': days = 7; break;
                case '30d': days = 30; break;
                case '90d': days = 90; break;
                case '1y': days = 365; break;
            }
            
            const newData = generateTimeSeriesData(days, 5.71);
            emissionsChart.data.labels = newData.labels;
            emissionsChart.data.datasets[0].data = newData.data;
            emissionsChart.data.datasets[1].data = newData.data.map((v, i) => 
                i > days * 0.7 ? v * (1 + (i - days * 0.7) * 0.005) : null
            );
            emissionsChart.update();
        }
        
        // Real-time updates simulation
        function updateRealTimeData() {
            // Update current footprint
            const currentElement = document.getElementById('currentFootprint');
            const currentValue = parseFloat(currentElement.textContent);
            const newValue = currentValue + (Math.random() - 0.5) * 0.1;
            currentElement.textContent = Math.max(0, newValue).toFixed(2);
            
            // Update last update time
            document.getElementById('lastUpdate').textContent = 'Updated now';
            setTimeout(() => {
                document.getElementById('lastUpdate').textContent = 'Updated 1 min ago';
            }, 60000);
        }
        
        // Simulate real-time updates every 30 seconds
        setInterval(updateRealTimeData, 30000);
        
        // Advanced analytics functions
        function calculateTrends() {
            // Simulate trend calculation
            return {
                daily: -0.023,
                weekly: -0.156,
                monthly: -0.672
            };
        }
        
        function generatePredictions() {
            // Simulate ML prediction generation
            return {
                nextWeek: 5.34,
                nextMonth: 159.8,
                confidence: 0.891
            };
        }
        
        // Environmental impact calculations
        function calculateEnvironmentalImpact(emissions) {
            return {
                treesEquivalent: emissions * 0.0376, // Trees needed to offset
                carMiles: emissions * 2.31, // Equivalent car miles
                homeEnergy: emissions * 0.12 // Days of average home energy
            };
        }
        
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Carbon-Neural Dashboard initialized');
            console.log('AI Engine: Active');
            console.log('Real-time monitoring: Enabled');
            console.log('Hedera integration: Connected');
            
            // Add some interactive hover effects
            document.querySelectorAll('.metric-card').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-6px) scale(1.02)';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(-4px) scale(1)';
                });
            });
        });
        
        // Export functionality for data sharing
        function exportDashboardData() {
            const dashboardData = {
                timestamp: new Date().toISOString(),
                currentFootprint: document.getElementById('currentFootprint').textContent,
                trends: calculateTrends(),
                predictions: generatePredictions(),
                modelAccuracy: 0.942
            };
            
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(dashboardData, null, 2));
            const downloadElement = document.createElement('a');
            downloadElement.setAttribute("href", dataStr);
            downloadElement.setAttribute("download", "carbon-neural-data.json");
            downloadElement.click();
        }
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'e':
                        e.preventDefault();
                        exportDashboardData();
                        break;
                    case 'r':
                        e.preventDefault();
                        location.reload();
                        break;
                }
            }
        });
    </script>
</body>
</html>